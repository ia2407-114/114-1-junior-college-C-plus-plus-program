#include <stdio.h>
#include <string.h>
#define SIZE 10
struct student
{
    char name[20];
    int id, computer, math;
    float avg;
};
void sort_array(struct student stud[SIZE], int n) {
    int i, j;
    struct student temp;
 

    for (i = 0; i < n - 1; i++) {
        for (j = 0; j < n - 1 - i; j++) {
            if (stud[j].avg < stud[j + 1].avg) {
                temp = stud[j];
                stud[j] = stud[j + 1];
                stud[j + 1] = temp;
            }
        }
    }
}
int binarySearch(const int b[], int searchKey, int low, int high)
{
    while (low <= high) {
        int middle = (low + high) / 2;
        if (searchKey == b[middle]) {
            return middle;
        }
        else if (searchKey < b[middle]) {
            high = middle - 1;
        }
        else {
            low = middle + 1;
        }
    }
    return -1;
}
int main() {
    struct student stud[SIZE] = { {"Danny",1,85,70},
                     {"Mary",2,92,80},
                     {"Jimmy",3,78,75},
                     {"Peter",4,85,90},
                     {"Sue",5,90,85},
                     {"John",6,85,70},
                     {"Hearts",7,76,82},
                     {"Diamond",8,95,92},
                     {"Clubs",9,88,88},
                     {"Spades",10,85,70}, };
    int i, key, result;
    int id[SIZE];
    for (i = 0; i < SIZE; i++) {
        stud[i].avg = (float)(stud[i].computer + stud[i].math) / 2.0;
    }
    for (i = 0; i < SIZE; i++) {
        id[i] = stud[i].id;
    }
    printf("請輸入你要找的學號鍵質\n");
    scanf_s("%d", &key);
    result = binarySearch(id, key, 0, SIZE-1);
    if (result == -1) {
        printf("找不到資料!\n");
    }
    else
    {
        printf("學生姓名%s 學生學號%d 計概成績%d 數學成績%d 平均成績%f",
            stud[result].name,
            stud[result].id,
            stud[result].computer,
            stud[result].math,
            stud[result].avg);
    }
    printf("排序前：\n");
    printf("姓名\t學號\t計概成績\t數學成績\t平均成績\n");
    
    for (i = 0; i < SIZE; i++) {
        printf("%s\t%d\t    %d\t\t    %d\t\t    %f\t\n", stud[i].name, stud[i].id, stud[i].computer, stud[i].math, stud[i].avg);
    }
    sort_array(stud, SIZE);
    printf("\n排序後（依平均成績）：\n");
    printf("姓名\t學號\t計概成績\t數學成績\t平均成績\n");
    for (i = 0; i < SIZE; i++) {
        printf("%s\t%d\t    %d\t\t    %d\t\t    %f\t\n", stud[i].name, stud[i].id, stud[i].computer, stud[i].math, stud[i].avg);
    }
    return 0;
}
