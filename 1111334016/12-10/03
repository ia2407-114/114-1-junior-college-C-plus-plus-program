//題目3 :建立三個大小為10的整數陣列、一個浮點數陣列，從鍵盤輸入資料，
// 分別存放學生學號以對應的計概、數學與平均成績。寫一個排序副程式與眾數副程式，
// 將三個陣列傳遞至副程式中，分別求出排序後的結果以及傳回眾數，
// 最後由主程式計算出每個學生的平均成績放到浮點數陣列印出所有結果
#include <stdio.h>
#define number 3
int findMode(int arr[], int n);
int bubble(int clas[], int count[], int math[], double avg[], int length);
int main(void) {
    int i, p;
    printf("請輸入1到10個同學的學號、計蓋和數學成績");
    int clas[number];
    int count[number];
    int math[number];
    double avg[number];
    for (i = 0;i < number;++i) {
        printf("\n請輸入第%d位同學的學號:", i + 1);
        scanf_s("%d", &clas[i]);
        printf("計蓋成績:");
        scanf_s("%d", &count[i]);
        printf("數學成績:");
        scanf_s("%d", &math[i]);
        printf("平均成績:");
        avg[i] = (count[i] + math[i]) / 2;
        printf("%f", avg[i]);
        puts("");
    }
    printf("       排序前結果       \n");
    printf(" 學號    計蓋成績    數學成績    平均成績\n");
    for (i = 0;i < number;++i) {
        printf("  %d        %d          %d          %f\n", clas[i], count[i], math[i], avg[i]);

    }
    int csMode = findMode(count, number);
    bubble(clas, count, math, avg, number);
    printf("       排序後結果       \n");
    printf(" 學號    計蓋成績    數學成績    平均成績\n");
    for (i = 0;i < number;++i) {
        printf("  %d        %d          %d          %f\n", clas[i], count[i], math[i], avg[i]);

    }
    printf("\n計概成績的眾數 = %d\n", csMode);
}

int bubble(int clas[], int count[], int math[], double avg[], int length)
{
    int pass, i;
    double temp;// temp 用於交換平均成績
    int temp_count; // 專門用於交換計蓋       //ex:12 13 14
    int temp_math; // 專門用於交換數學
    int temp_clas; // 專門用於交換學號
    for (pass = 1; pass < length; ++pass) {  //   66 67 66
        // 作用:外層迴圈。控制需要進行的「遍歷次數」
        // 對於10個元素，最多需要9次（pass 從1到9）遍歷來確保排序完成。
        // 在每次遍歷結束後，最大的未排序元素會「浮」到最右端。

        for (i = 0; i < length - 1; ++i) {
            // 內層迴圈。控制每一次遍歷中需要進行的「相鄰元素比較次數」。
 // 遍歷陣列，比較索引 i 和 i + 1 的元素。每次遍歷只需要比較到倒數第二個元素(length - 1 次比較)
            if (avg[i] > avg[i + 1]) {  // scr[1]>scr[2] 67>66

                // 1. 交換成績 (avg) 
                temp = avg[i];     //temp=67
                avg[i] = avg[i + 1]; //scr[1]=66
                avg[i + 1] = temp;  //scr[2]=67
                //66 67

                // 2. 同步交換學號 clas
                temp_clas = clas[i];  //temp_id=13
                clas[i] = clas[i + 1];//id[1]=14
                clas[i + 1] = temp_clas;//id[2]=13
                //14 13
                //66 67
                temp_count = count[i];
                count[i] = count[i + 1];
                count[i + 1] = temp_count;

                temp_math = math[i];
                math[i] = math[i + 1];
                math[i + 1] = temp_math;
            }
        }
    }
    return 0;
}

int findMode(int arr[], int n) {
    int mode = arr[0];
    int maxCount = 0;

    for (int i = 0; i < n; i++) {
        int count = 1;
        for (int j = i + 1; j < n; j++) {
            if (arr[i] == arr[j])
                count++;
        }
        if (count > maxCount) {
            maxCount = count;
            mode = arr[i];
        }
    }
    return mode;
}
